c5c6c27111e3fd653d2e554dfee2fedd
"use strict";
var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const AuthenticateQueryHandler_1 = __importDefault(require("../../../../src/modules/auth/application/login/AuthenticateQueryHandler"));
const Authenticator_1 = __importDefault(require("../../../../src/modules/auth/application/login/Authenticator"));
const AuthTokenRepositoryMock_1 = __importDefault(require("../__mocks__/AuthTokenRepositoryMock"));
const AuthUserRepositoryMock_1 = __importDefault(require("../__mocks__/AuthUserRepositoryMock"));
const AuthUserMother_1 = __importDefault(require("../domain/AuthUserMother"));
const AuthenticateQueryMother_1 = __importDefault(require("./AuthenticateQueryMother"));
let authUserRepository;
let authTokenRepository;
let authenticateQueryHandler;
beforeEach(() => {
    authTokenRepository = new AuthTokenRepositoryMock_1.default();
    authUserRepository = new AuthUserRepositoryMock_1.default();
    authenticateQueryHandler = new AuthenticateQueryHandler_1.default(new Authenticator_1.default(authUserRepository, authTokenRepository));
});
describe('Authenticator', () => {
    it('should create a valid auth token', () => __awaiter(void 0, void 0, void 0, function* () {
        const query = AuthenticateQueryMother_1.default.random();
        const authUser = AuthUserMother_1.default.fromQuery(query);
        authUserRepository.mockReturn(authUser);
        const authToken = yield authenticateQueryHandler.handle(query);
        expect(authToken.toString()).toBeDefined();
    }));
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2N1YXRyb29jaGVudGEvTWFnaWNTaG9wcGVyL21hZ2ljc2hvcHBlci1ub2RlL3Rlc3RzL21vZHVsZXMvYXV0aC9hcHBsaWNhdGlvbi9BdXRoZW50aWNhdG9yLnRlc3QudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7QUFBQSx1SUFBK0c7QUFDL0csaUhBQXlGO0FBRXpGLG1HQUEyRTtBQUMzRSxpR0FBeUU7QUFDekUsOEVBQXNEO0FBQ3RELHdGQUFnRTtBQUVoRSxJQUFJLGtCQUEwQyxDQUFDO0FBQy9DLElBQUksbUJBQXdDLENBQUM7QUFDN0MsSUFBSSx3QkFBa0QsQ0FBQztBQUV2RCxVQUFVLENBQUMsR0FBRyxFQUFFO0lBQ1osbUJBQW1CLEdBQUcsSUFBSSxpQ0FBdUIsRUFBRSxDQUFDO0lBQ3BELGtCQUFrQixHQUFHLElBQUksZ0NBQXNCLEVBQUUsQ0FBQztJQUNsRCx3QkFBd0IsR0FBRyxJQUFJLGtDQUF3QixDQUFDLElBQUksdUJBQWEsQ0FBQyxrQkFBa0IsRUFBRSxtQkFBbUIsQ0FBQyxDQUFDLENBQUE7QUFDdkgsQ0FBQyxDQUFDLENBQUM7QUFFSCxRQUFRLENBQUMsZUFBZSxFQUFFLEdBQUcsRUFBRTtJQUMzQixFQUFFLENBQUMsa0NBQWtDLEVBQUUsR0FBUyxFQUFFO1FBQzlDLE1BQU0sS0FBSyxHQUFHLGlDQUF1QixDQUFDLE1BQU0sRUFBRSxDQUFDO1FBQy9DLE1BQU0sUUFBUSxHQUFHLHdCQUFjLENBQUMsU0FBUyxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQ2pELGtCQUFrQixDQUFDLFVBQVUsQ0FBQyxRQUFRLENBQUMsQ0FBQztRQUV4QyxNQUFNLFNBQVMsR0FBRyxNQUFNLHdCQUF3QixDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUUvRCxNQUFNLENBQUMsU0FBUyxDQUFDLFFBQVEsRUFBRSxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUM7SUFDL0MsQ0FBQyxDQUFBLENBQUMsQ0FBQztBQUNQLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy9jdWF0cm9vY2hlbnRhL01hZ2ljU2hvcHBlci9tYWdpY3Nob3BwZXItbm9kZS90ZXN0cy9tb2R1bGVzL2F1dGgvYXBwbGljYXRpb24vQXV0aGVudGljYXRvci50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBBdXRoZW50aWNhdGVRdWVyeUhhbmRsZXIgZnJvbSAnLi4vLi4vLi4vLi4vc3JjL21vZHVsZXMvYXV0aC9hcHBsaWNhdGlvbi9sb2dpbi9BdXRoZW50aWNhdGVRdWVyeUhhbmRsZXInO1xuaW1wb3J0IEF1dGhlbnRpY2F0b3IgZnJvbSAnLi4vLi4vLi4vLi4vc3JjL21vZHVsZXMvYXV0aC9hcHBsaWNhdGlvbi9sb2dpbi9BdXRoZW50aWNhdG9yJztcbmltcG9ydCBBdXRoVG9rZW5SZXBvc2l0b3J5IGZyb20gJy4uLy4uLy4uLy4uL3NyYy9tb2R1bGVzL2F1dGgvZG9tYWluL0F1dGhUb2tlblJlcG9zaXRvcnknO1xuaW1wb3J0IEF1dGhUb2tlblJlcG9zaXRvcnlNb2NrIGZyb20gJy4uL19fbW9ja3NfXy9BdXRoVG9rZW5SZXBvc2l0b3J5TW9jayc7XG5pbXBvcnQgQXV0aFVzZXJSZXBvc2l0b3J5TW9jayBmcm9tICcuLi9fX21vY2tzX18vQXV0aFVzZXJSZXBvc2l0b3J5TW9jayc7XG5pbXBvcnQgQXV0aFVzZXJNb3RoZXIgZnJvbSAnLi4vZG9tYWluL0F1dGhVc2VyTW90aGVyJztcbmltcG9ydCBBdXRoZW50aWNhdGVRdWVyeU1vdGhlciBmcm9tICcuL0F1dGhlbnRpY2F0ZVF1ZXJ5TW90aGVyJztcblxubGV0IGF1dGhVc2VyUmVwb3NpdG9yeTogQXV0aFVzZXJSZXBvc2l0b3J5TW9jaztcbmxldCBhdXRoVG9rZW5SZXBvc2l0b3J5OiBBdXRoVG9rZW5SZXBvc2l0b3J5O1xubGV0IGF1dGhlbnRpY2F0ZVF1ZXJ5SGFuZGxlcjogQXV0aGVudGljYXRlUXVlcnlIYW5kbGVyO1xuXG5iZWZvcmVFYWNoKCgpID0+IHtcbiAgICBhdXRoVG9rZW5SZXBvc2l0b3J5ID0gbmV3IEF1dGhUb2tlblJlcG9zaXRvcnlNb2NrKCk7XG4gICAgYXV0aFVzZXJSZXBvc2l0b3J5ID0gbmV3IEF1dGhVc2VyUmVwb3NpdG9yeU1vY2soKTtcbiAgICBhdXRoZW50aWNhdGVRdWVyeUhhbmRsZXIgPSBuZXcgQXV0aGVudGljYXRlUXVlcnlIYW5kbGVyKG5ldyBBdXRoZW50aWNhdG9yKGF1dGhVc2VyUmVwb3NpdG9yeSwgYXV0aFRva2VuUmVwb3NpdG9yeSkpXG59KTtcblxuZGVzY3JpYmUoJ0F1dGhlbnRpY2F0b3InLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBjcmVhdGUgYSB2YWxpZCBhdXRoIHRva2VuJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCBxdWVyeSA9IEF1dGhlbnRpY2F0ZVF1ZXJ5TW90aGVyLnJhbmRvbSgpO1xuICAgICAgICBjb25zdCBhdXRoVXNlciA9IEF1dGhVc2VyTW90aGVyLmZyb21RdWVyeShxdWVyeSk7XG4gICAgICAgIGF1dGhVc2VyUmVwb3NpdG9yeS5tb2NrUmV0dXJuKGF1dGhVc2VyKTtcblxuICAgICAgICBjb25zdCBhdXRoVG9rZW4gPSBhd2FpdCBhdXRoZW50aWNhdGVRdWVyeUhhbmRsZXIuaGFuZGxlKHF1ZXJ5KTtcblxuICAgICAgICBleHBlY3QoYXV0aFRva2VuLnRvU3RyaW5nKCkpLnRvQmVEZWZpbmVkKCk7XG4gICAgfSk7XG59KTtcbiJdLCJ2ZXJzaW9uIjozfQ==