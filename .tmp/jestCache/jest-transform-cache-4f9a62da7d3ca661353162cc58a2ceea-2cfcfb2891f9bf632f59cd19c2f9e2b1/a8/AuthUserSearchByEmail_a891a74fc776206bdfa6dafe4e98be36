9c97d214c5b4649ea7bebde3cf0d34b5
"use strict";
var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const Criteria_1 = require("@microk/common/criteria/Criteria");
const Filter_1 = require("@microk/common/criteria/Filter");
const FilterField_1 = require("@microk/common/criteria/FilterField");
const FilterOperator_1 = require("@microk/common/criteria/FilterOperator");
const Filters_1 = require("@microk/common/criteria/Filters");
const FilterValue_1 = require("@microk/common/criteria/FilterValue");
const Order_1 = require("@microk/common/criteria/Order");
const NotFoundHttpError_1 = __importDefault(require("@microk/common/http/errors/NotFoundHttpError"));
class AuthUserSearchByEmail {
    constructor(authUserRepository) {
        this.authUserRepository = authUserRepository;
    }
    search(email) {
        return __awaiter(this, void 0, void 0, function* () {
            const criteria = this.buildCriteria(email);
            const authUser = this.authUserRepository.searchOneByCriteria(criteria);
            if (!authUser) {
                throw new NotFoundHttpError_1.default(`Not found user with email <${email.toString()}>`);
            }
            return authUser;
        });
    }
    buildCriteria(email) {
        return new Criteria_1.Criteria(new Filters_1.Filters([new Filter_1.Filter(new FilterField_1.FilterField('email'), FilterOperator_1.FilterOperator.equal(), new FilterValue_1.FilterValue(email.toString()))]), Order_1.Order.none());
    }
}
exports.default = AuthUserSearchByEmail;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2N1YXRyb29jaGVudGEvTWFnaWNTaG9wcGVyL21hZ2ljc2hvcHBlci1ub2RlL3NyYy9tb2R1bGVzL2F1dGgvYXBwbGljYXRpb24vc2VhcmNoLWJ5LWVtYWlsL0F1dGhVc2VyU2VhcmNoQnlFbWFpbC50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OztBQUFBLCtEQUE0RDtBQUM1RCwyREFBd0Q7QUFDeEQscUVBQWtFO0FBQ2xFLDJFQUF3RTtBQUN4RSw2REFBMEQ7QUFDMUQscUVBQWtFO0FBQ2xFLHlEQUFzRDtBQUN0RCxxR0FBNkU7QUFLN0UsTUFBcUIscUJBQXFCO0lBQ3RDLFlBQ3FCLGtCQUFzQztRQUF0Qyx1QkFBa0IsR0FBbEIsa0JBQWtCLENBQW9CO0lBRTNELENBQUM7SUFFWSxNQUFNLENBQUMsS0FBb0I7O1lBQ3BDLE1BQU0sUUFBUSxHQUFHLElBQUksQ0FBQyxhQUFhLENBQUMsS0FBSyxDQUFDLENBQUE7WUFFMUMsTUFBTSxRQUFRLEdBQUcsSUFBSSxDQUFDLGtCQUFrQixDQUFDLG1CQUFtQixDQUFDLFFBQVEsQ0FBQyxDQUFDO1lBRXZFLElBQUksQ0FBQyxRQUFRLEVBQUU7Z0JBQ1gsTUFBTSxJQUFJLDJCQUFpQixDQUFDLDhCQUE4QixLQUFLLENBQUMsUUFBUSxFQUFFLEdBQUcsQ0FBQyxDQUFBO2FBQ2pGO1lBRUQsT0FBTyxRQUFRLENBQUM7UUFDcEIsQ0FBQztLQUFBO0lBRU8sYUFBYSxDQUFDLEtBQW9CO1FBQ3RDLE9BQU8sSUFBSSxtQkFBUSxDQUNmLElBQUksaUJBQU8sQ0FBQyxDQUFDLElBQUksZUFBTSxDQUNuQixJQUFJLHlCQUFXLENBQUMsT0FBTyxDQUFDLEVBQ3hCLCtCQUFjLENBQUMsS0FBSyxFQUFFLEVBQ3RCLElBQUkseUJBQVcsQ0FBQyxLQUFLLENBQUMsUUFBUSxFQUFFLENBQUMsQ0FDcEMsQ0FBQyxDQUFDLEVBQ0gsYUFBSyxDQUFDLElBQUksRUFBRSxDQUNmLENBQUM7SUFDTixDQUFDO0NBQ0o7QUE1QkQsd0NBNEJDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy9jdWF0cm9vY2hlbnRhL01hZ2ljU2hvcHBlci9tYWdpY3Nob3BwZXItbm9kZS9zcmMvbW9kdWxlcy9hdXRoL2FwcGxpY2F0aW9uL3NlYXJjaC1ieS1lbWFpbC9BdXRoVXNlclNlYXJjaEJ5RW1haWwudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ3JpdGVyaWEgfSBmcm9tICdAbWljcm9rL2NvbW1vbi9jcml0ZXJpYS9Dcml0ZXJpYSc7XG5pbXBvcnQgeyBGaWx0ZXIgfSBmcm9tICdAbWljcm9rL2NvbW1vbi9jcml0ZXJpYS9GaWx0ZXInO1xuaW1wb3J0IHsgRmlsdGVyRmllbGQgfSBmcm9tICdAbWljcm9rL2NvbW1vbi9jcml0ZXJpYS9GaWx0ZXJGaWVsZCc7XG5pbXBvcnQgeyBGaWx0ZXJPcGVyYXRvciB9IGZyb20gJ0BtaWNyb2svY29tbW9uL2NyaXRlcmlhL0ZpbHRlck9wZXJhdG9yJztcbmltcG9ydCB7IEZpbHRlcnMgfSBmcm9tICdAbWljcm9rL2NvbW1vbi9jcml0ZXJpYS9GaWx0ZXJzJztcbmltcG9ydCB7IEZpbHRlclZhbHVlIH0gZnJvbSAnQG1pY3Jvay9jb21tb24vY3JpdGVyaWEvRmlsdGVyVmFsdWUnO1xuaW1wb3J0IHsgT3JkZXIgfSBmcm9tICdAbWljcm9rL2NvbW1vbi9jcml0ZXJpYS9PcmRlcic7XG5pbXBvcnQgTm90Rm91bmRIdHRwRXJyb3IgZnJvbSAnQG1pY3Jvay9jb21tb24vaHR0cC9lcnJvcnMvTm90Rm91bmRIdHRwRXJyb3InO1xuaW1wb3J0IHsgQXV0aFVzZXIgfSBmcm9tICcuLi8uLi9kb21haW4vQXV0aFVzZXInO1xuaW1wb3J0IEF1dGhVc2VyRW1haWwgZnJvbSAnLi4vLi4vZG9tYWluL0F1dGhVc2VyRW1haWwnO1xuaW1wb3J0IHsgQXV0aFVzZXJSZXBvc2l0b3J5IH0gZnJvbSAnLi4vLi4vZG9tYWluL0F1dGhVc2VyUmVwb3NpdG9yeSc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEF1dGhVc2VyU2VhcmNoQnlFbWFpbCB7XG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgcmVhZG9ubHkgYXV0aFVzZXJSZXBvc2l0b3J5OiBBdXRoVXNlclJlcG9zaXRvcnksXG4gICAgKSB7XG4gICAgfVxuXG4gICAgcHVibGljIGFzeW5jIHNlYXJjaChlbWFpbDogQXV0aFVzZXJFbWFpbCk6IFByb21pc2U8Tm9uTnVsbGFibGU8QXV0aFVzZXI+PiB7XG4gICAgICAgIGNvbnN0IGNyaXRlcmlhID0gdGhpcy5idWlsZENyaXRlcmlhKGVtYWlsKVxuXG4gICAgICAgIGNvbnN0IGF1dGhVc2VyID0gdGhpcy5hdXRoVXNlclJlcG9zaXRvcnkuc2VhcmNoT25lQnlDcml0ZXJpYShjcml0ZXJpYSk7XG5cbiAgICAgICAgaWYgKCFhdXRoVXNlcikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kSHR0cEVycm9yKGBOb3QgZm91bmQgdXNlciB3aXRoIGVtYWlsIDwke2VtYWlsLnRvU3RyaW5nKCl9PmApXG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gYXV0aFVzZXI7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBidWlsZENyaXRlcmlhKGVtYWlsOiBBdXRoVXNlckVtYWlsKSB7XG4gICAgICAgIHJldHVybiBuZXcgQ3JpdGVyaWEoXG4gICAgICAgICAgICBuZXcgRmlsdGVycyhbbmV3IEZpbHRlcihcbiAgICAgICAgICAgICAgICBuZXcgRmlsdGVyRmllbGQoJ2VtYWlsJyksXG4gICAgICAgICAgICAgICAgRmlsdGVyT3BlcmF0b3IuZXF1YWwoKSxcbiAgICAgICAgICAgICAgICBuZXcgRmlsdGVyVmFsdWUoZW1haWwudG9TdHJpbmcoKSksXG4gICAgICAgICAgICApXSksXG4gICAgICAgICAgICBPcmRlci5ub25lKCksXG4gICAgICAgICk7XG4gICAgfVxufVxuIl0sInZlcnNpb24iOjN9