e02c5d0ea70e049cc7ff43ac2732146f
"use strict";
var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const index_1 = __importDefault(require("./index"));
describe('OpenApi', () => {
    it('should create a valid auth token', () => __awaiter(void 0, void 0, void 0, function* () {
        const openApi = new index_1.default({
            baseDir: `${__dirname}/examples`,
            filesPattern: './*.ts',
            info: {
                title: 'Test',
                version: '1.0.0',
                description: 'Public API',
                license: {
                    name: 'MIT',
                },
            },
            components: {
                securitySchemes: {
                    jwt: {
                        type: 'http',
                        scheme: 'bearer',
                        bearerFormat: 'JWT',
                    },
                },
            },
        });
        const openApiDoc = openApi.generateDocs();
        expect(openApiDoc).toEqual({
            openapi: '3.0.0',
            info: {
                title: 'Test',
                version: '1.0.0',
                description: 'Public API',
                license: {
                    name: 'MIT',
                },
            },
            paths: {
                '/notification': {
                    post: {
                        operationId: 'addJob',
                        tags: [
                            'jobs',
                        ],
                        summary: 'Creates a new notification.',
                        description: '',
                        security: [
                            {
                                jwt: [],
                            },
                        ],
                        requestBody: {
                            description: 'Notification object to create',
                            required: true,
                            content: {
                                'application/json': {
                                    schema: {
                                        $ref: '#/components/schemas/Notification',
                                    },
                                },
                            },
                        },
                        responses: {
                            201: {
                                description: 'Successful operation. The notification has been created on the server.',
                                content: {
                                    'application/json': {
                                        schema: {
                                            $ref: '#/components/schemas/Notification',
                                        },
                                    },
                                },
                            },
                            400: {
                                description: 'Bad Request',
                                content: {
                                    'application/json': {
                                        schema: {
                                            $ref: '#/components/schemas/Error',
                                        },
                                    },
                                },
                            },
                        },
                    },
                },
            },
            components: {
                securitySchemes: {
                    jwt: {
                        type: 'http',
                        scheme: 'bearer',
                        bearerFormat: 'JWT',
                    },
                },
                schemas: {
                    Error: {
                        type: 'object',
                        properties: {
                            message: {
                                type: 'string',
                            },
                            code: {
                                type: 'integer',
                                example: 404,
                            },
                        },
                    },
                    Notification: {
                        type: 'object',
                        required: [
                            'serviceUrl',
                        ],
                        properties: {
                            serviceUrl: {
                                type: 'string',
                            },
                            authenticationHeader: {
                                type: 'string',
                            },
                            certificateSubject: {
                                type: 'string',
                            },
                            parameters: {
                                type: 'string',
                            },
                        },
                    },
                },
            },
        });
    }));
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2N1YXRyb29jaGVudGEvTWFnaWNTaG9wcGVyL21hZ2ljc2hvcHBlci1ub2RlL3NyYy9taWNyb2svZG9jcy9vcGVuYXBpL2luZGV4LnRlc3QudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7QUFBQSxvREFBOEI7QUFFOUIsUUFBUSxDQUFDLFNBQVMsRUFBRSxHQUFHLEVBQUU7SUFDckIsRUFBRSxDQUFDLGtDQUFrQyxFQUFFLEdBQVMsRUFBRTtRQUM5QyxNQUFNLE9BQU8sR0FBRyxJQUFJLGVBQU8sQ0FBQztZQUN4QixPQUFPLEVBQUUsR0FBRyxTQUFTLFdBQVc7WUFDaEMsWUFBWSxFQUFFLFFBQVE7WUFDdEIsSUFBSSxFQUFFO2dCQUNGLEtBQUssRUFBRSxNQUFNO2dCQUNiLE9BQU8sRUFBRSxPQUFPO2dCQUNoQixXQUFXLEVBQUUsWUFBWTtnQkFDekIsT0FBTyxFQUFFO29CQUNMLElBQUksRUFBRSxLQUFLO2lCQUNkO2FBQ0o7WUFDRCxVQUFVLEVBQUU7Z0JBQ1IsZUFBZSxFQUFFO29CQUNiLEdBQUcsRUFBRTt3QkFDRCxJQUFJLEVBQUUsTUFBTTt3QkFDWixNQUFNLEVBQUUsUUFBUTt3QkFDaEIsWUFBWSxFQUFFLEtBQUs7cUJBQ3RCO2lCQUNKO2FBQ0o7U0FDSixDQUFDLENBQUE7UUFFRixNQUFNLFVBQVUsR0FBRyxPQUFPLENBQUMsWUFBWSxFQUFFLENBQUM7UUFFMUMsTUFBTSxDQUFDLFVBQVUsQ0FBQyxDQUFDLE9BQU8sQ0FBQztZQUN2QixPQUFPLEVBQUUsT0FBTztZQUNoQixJQUFJLEVBQUU7Z0JBQ0YsS0FBSyxFQUFFLE1BQU07Z0JBQ2IsT0FBTyxFQUFFLE9BQU87Z0JBQ2hCLFdBQVcsRUFBRSxZQUFZO2dCQUN6QixPQUFPLEVBQUU7b0JBQ0wsSUFBSSxFQUFFLEtBQUs7aUJBQ2Q7YUFDSjtZQUNELEtBQUssRUFBRTtnQkFDSCxlQUFlLEVBQUU7b0JBQ2IsSUFBSSxFQUFFO3dCQUNGLFdBQVcsRUFBRSxRQUFRO3dCQUNyQixJQUFJLEVBQUU7NEJBQ0YsTUFBTTt5QkFDVDt3QkFDRCxPQUFPLEVBQUUsNkJBQTZCO3dCQUN0QyxXQUFXLEVBQUUsRUFBRTt3QkFDZixRQUFRLEVBQUU7NEJBQ047Z0NBQ0ksR0FBRyxFQUFFLEVBQUU7NkJBQ1Y7eUJBQ0o7d0JBQ0QsV0FBVyxFQUFFOzRCQUNULFdBQVcsRUFBRSwrQkFBK0I7NEJBQzVDLFFBQVEsRUFBRSxJQUFJOzRCQUNkLE9BQU8sRUFBRTtnQ0FDTCxrQkFBa0IsRUFBRTtvQ0FDaEIsTUFBTSxFQUFFO3dDQUNKLElBQUksRUFBRSxtQ0FBbUM7cUNBQzVDO2lDQUNKOzZCQUNKO3lCQUNKO3dCQUNELFNBQVMsRUFBRTs0QkFDUCxHQUFHLEVBQUU7Z0NBQ0QsV0FBVyxFQUFFLHdFQUF3RTtnQ0FDckYsT0FBTyxFQUFFO29DQUNMLGtCQUFrQixFQUFFO3dDQUNoQixNQUFNLEVBQUU7NENBQ0osSUFBSSxFQUFFLG1DQUFtQzt5Q0FDNUM7cUNBQ0o7aUNBQ0o7NkJBQ0o7NEJBQ0QsR0FBRyxFQUFFO2dDQUNELFdBQVcsRUFBRSxhQUFhO2dDQUMxQixPQUFPLEVBQUU7b0NBQ0wsa0JBQWtCLEVBQUU7d0NBQ2hCLE1BQU0sRUFBRTs0Q0FDSixJQUFJLEVBQUUsNEJBQTRCO3lDQUNyQztxQ0FDSjtpQ0FDSjs2QkFDSjt5QkFDSjtxQkFDSjtpQkFDSjthQUNKO1lBQ0QsVUFBVSxFQUFFO2dCQUNSLGVBQWUsRUFBRTtvQkFDYixHQUFHLEVBQUU7d0JBQ0QsSUFBSSxFQUFFLE1BQU07d0JBQ1osTUFBTSxFQUFFLFFBQVE7d0JBQ2hCLFlBQVksRUFBRSxLQUFLO3FCQUN0QjtpQkFDSjtnQkFDRCxPQUFPLEVBQUU7b0JBQ0wsS0FBSyxFQUFFO3dCQUNILElBQUksRUFBRSxRQUFRO3dCQUNkLFVBQVUsRUFBRTs0QkFDUixPQUFPLEVBQUU7Z0NBQ0wsSUFBSSxFQUFFLFFBQVE7NkJBQ2pCOzRCQUNELElBQUksRUFBRTtnQ0FDRixJQUFJLEVBQUUsU0FBUztnQ0FDZixPQUFPLEVBQUUsR0FBRzs2QkFDZjt5QkFDSjtxQkFDSjtvQkFDRCxZQUFZLEVBQUU7d0JBQ1YsSUFBSSxFQUFFLFFBQVE7d0JBQ2QsUUFBUSxFQUFFOzRCQUNOLFlBQVk7eUJBQ2Y7d0JBQ0QsVUFBVSxFQUFFOzRCQUNSLFVBQVUsRUFBRTtnQ0FDUixJQUFJLEVBQUUsUUFBUTs2QkFDakI7NEJBQ0Qsb0JBQW9CLEVBQUU7Z0NBQ2xCLElBQUksRUFBRSxRQUFROzZCQUNqQjs0QkFDRCxrQkFBa0IsRUFBRTtnQ0FDaEIsSUFBSSxFQUFFLFFBQVE7NkJBQ2pCOzRCQUNELFVBQVUsRUFBRTtnQ0FDUixJQUFJLEVBQUUsUUFBUTs2QkFDakI7eUJBQ0o7cUJBQ0o7aUJBQ0o7YUFDSjtTQUNKLENBQUMsQ0FBQTtJQUNOLENBQUMsQ0FBQSxDQUFDLENBQUM7QUFDUCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvVXNlcnMvY3VhdHJvb2NoZW50YS9NYWdpY1Nob3BwZXIvbWFnaWNzaG9wcGVyLW5vZGUvc3JjL21pY3Jvay9kb2NzL29wZW5hcGkvaW5kZXgudGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgT3BlbkFwaSBmcm9tICcuL2luZGV4JztcblxuZGVzY3JpYmUoJ09wZW5BcGknLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBjcmVhdGUgYSB2YWxpZCBhdXRoIHRva2VuJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCBvcGVuQXBpID0gbmV3IE9wZW5BcGkoe1xuICAgICAgICAgICAgYmFzZURpcjogYCR7X19kaXJuYW1lfS9leGFtcGxlc2AsXG4gICAgICAgICAgICBmaWxlc1BhdHRlcm46ICcuLyoudHMnLFxuICAgICAgICAgICAgaW5mbzoge1xuICAgICAgICAgICAgICAgIHRpdGxlOiAnVGVzdCcsXG4gICAgICAgICAgICAgICAgdmVyc2lvbjogJzEuMC4wJyxcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogJ1B1YmxpYyBBUEknLFxuICAgICAgICAgICAgICAgIGxpY2Vuc2U6IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogJ01JVCcsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBjb21wb25lbnRzOiB7XG4gICAgICAgICAgICAgICAgc2VjdXJpdHlTY2hlbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgIGp3dDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2h0dHAnLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2NoZW1lOiAnYmVhcmVyJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGJlYXJlckZvcm1hdDogJ0pXVCcsXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pXG5cbiAgICAgICAgY29uc3Qgb3BlbkFwaURvYyA9IG9wZW5BcGkuZ2VuZXJhdGVEb2NzKCk7XG5cbiAgICAgICAgZXhwZWN0KG9wZW5BcGlEb2MpLnRvRXF1YWwoe1xuICAgICAgICAgICAgb3BlbmFwaTogJzMuMC4wJyxcbiAgICAgICAgICAgIGluZm86IHtcbiAgICAgICAgICAgICAgICB0aXRsZTogJ1Rlc3QnLFxuICAgICAgICAgICAgICAgIHZlcnNpb246ICcxLjAuMCcsXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb246ICdQdWJsaWMgQVBJJyxcbiAgICAgICAgICAgICAgICBsaWNlbnNlOiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6ICdNSVQnLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcGF0aHM6IHtcbiAgICAgICAgICAgICAgICAnL25vdGlmaWNhdGlvbic6IHtcbiAgICAgICAgICAgICAgICAgICAgcG9zdDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgb3BlcmF0aW9uSWQ6ICdhZGRKb2InLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnczogW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdqb2JzJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAnQ3JlYXRlcyBhIG5ldyBub3RpZmljYXRpb24uJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiAnJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlY3VyaXR5OiBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqd3Q6IFtdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWVzdEJvZHk6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogJ05vdGlmaWNhdGlvbiBvYmplY3QgdG8gY3JlYXRlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdhcHBsaWNhdGlvbi9qc29uJzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJlZjogJyMvY29tcG9uZW50cy9zY2hlbWFzL05vdGlmaWNhdGlvbicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgMjAxOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiAnU3VjY2Vzc2Z1bCBvcGVyYXRpb24uIFRoZSBub3RpZmljYXRpb24gaGFzIGJlZW4gY3JlYXRlZCBvbiB0aGUgc2VydmVyLicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdhcHBsaWNhdGlvbi9qc29uJzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcmVmOiAnIy9jb21wb25lbnRzL3NjaGVtYXMvTm90aWZpY2F0aW9uJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDQwMDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogJ0JhZCBSZXF1ZXN0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2FwcGxpY2F0aW9uL2pzb24nOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyZWY6ICcjL2NvbXBvbmVudHMvc2NoZW1hcy9FcnJvcicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBjb21wb25lbnRzOiB7XG4gICAgICAgICAgICAgICAgc2VjdXJpdHlTY2hlbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgIGp3dDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2h0dHAnLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2NoZW1lOiAnYmVhcmVyJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGJlYXJlckZvcm1hdDogJ0pXVCcsXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBzY2hlbWFzOiB7XG4gICAgICAgICAgICAgICAgICAgIEVycm9yOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnb2JqZWN0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdzdHJpbmcnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29kZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnaW50ZWdlcicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4YW1wbGU6IDQwNCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgTm90aWZpY2F0aW9uOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnb2JqZWN0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3NlcnZpY2VVcmwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXJ2aWNlVXJsOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdzdHJpbmcnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXV0aGVudGljYXRpb25IZWFkZXI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3N0cmluZycsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjZXJ0aWZpY2F0ZVN1YmplY3Q6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3N0cmluZycsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJhbWV0ZXJzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdzdHJpbmcnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9LFxuICAgICAgICB9KVxuICAgIH0pO1xufSk7XG4iXSwidmVyc2lvbiI6M30=