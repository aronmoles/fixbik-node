090e96c5430e107a2eac3f37e4173fc6
"use strict";
var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
Object.defineProperty(exports, "__esModule", { value: true });
class LoginService {
    constructor(authUserRepository, authTokenRepository) {
        this.authUserRepository = authUserRepository;
        this.authTokenRepository = authTokenRepository;
    }
    run(email, password) {
        return __awaiter(this, void 0, void 0, function* () {
            // TODO extract to Domain Service and seearch by criteria
            const authUser = yield this.authUserRepository.searchByEmail(email);
            authUser.isValidPassword(password);
            return this.authTokenRepository.generate(authUser);
        });
    }
}
exports.default = LoginService;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2N1YXRyb29jaGVudGEvTWFnaWNTaG9wcGVyL21hZ2ljc2hvcHBlci1ub2RlL3NyYy9tb2R1bGVzL2F1dGgvYXBwbGljYXRpb24vbG9naW4vTG9naW5TZXJ2aWNlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBTUEsTUFBcUIsWUFBWTtJQUM3QixZQUNxQixrQkFBc0MsRUFDdEMsbUJBQXdDO1FBRHhDLHVCQUFrQixHQUFsQixrQkFBa0IsQ0FBb0I7UUFDdEMsd0JBQW1CLEdBQW5CLG1CQUFtQixDQUFxQjtJQUU3RCxDQUFDO0lBRUssR0FBRyxDQUFDLEtBQW9CLEVBQUUsUUFBMEI7O1lBQ3RELHlEQUF5RDtZQUN6RCxNQUFNLFFBQVEsR0FBRyxNQUFNLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxhQUFhLENBQUMsS0FBSyxDQUFDLENBQUM7WUFFcEUsUUFBUSxDQUFDLGVBQWUsQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUVuQyxPQUFPLElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUFDLENBQUM7UUFDdkQsQ0FBQztLQUFBO0NBQ0o7QUFmRCwrQkFlQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvVXNlcnMvY3VhdHJvb2NoZW50YS9NYWdpY1Nob3BwZXIvbWFnaWNzaG9wcGVyLW5vZGUvc3JjL21vZHVsZXMvYXV0aC9hcHBsaWNhdGlvbi9sb2dpbi9Mb2dpblNlcnZpY2UudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IEF1dGhUb2tlbiBmcm9tICcuLi8uLi9kb21haW4vQXV0aFRva2VuJztcbmltcG9ydCBBdXRoVG9rZW5SZXBvc2l0b3J5IGZyb20gJy4uLy4uL2RvbWFpbi9BdXRoVG9rZW5SZXBvc2l0b3J5JztcbmltcG9ydCBBdXRoVXNlckVtYWlsIGZyb20gJy4uLy4uL2RvbWFpbi9BdXRoVXNlckVtYWlsJztcbmltcG9ydCBBdXRoVXNlclBhc3N3b3JkIGZyb20gJy4uLy4uL2RvbWFpbi9BdXRoVXNlclBhc3N3b3JkJztcbmltcG9ydCB7IEF1dGhVc2VyUmVwb3NpdG9yeSB9IGZyb20gJy4uLy4uL2RvbWFpbi9BdXRoVXNlclJlcG9zaXRvcnknO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBMb2dpblNlcnZpY2Uge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIHJlYWRvbmx5IGF1dGhVc2VyUmVwb3NpdG9yeTogQXV0aFVzZXJSZXBvc2l0b3J5LFxuICAgICAgICBwcml2YXRlIHJlYWRvbmx5IGF1dGhUb2tlblJlcG9zaXRvcnk6IEF1dGhUb2tlblJlcG9zaXRvcnksXG4gICAgKSB7XG4gICAgfVxuXG4gICAgYXN5bmMgcnVuKGVtYWlsOiBBdXRoVXNlckVtYWlsLCBwYXNzd29yZDogQXV0aFVzZXJQYXNzd29yZCk6IFByb21pc2U8QXV0aFRva2VuPiB7XG4gICAgICAgIC8vIFRPRE8gZXh0cmFjdCB0byBEb21haW4gU2VydmljZSBhbmQgc2VlYXJjaCBieSBjcml0ZXJpYVxuICAgICAgICBjb25zdCBhdXRoVXNlciA9IGF3YWl0IHRoaXMuYXV0aFVzZXJSZXBvc2l0b3J5LnNlYXJjaEJ5RW1haWwoZW1haWwpO1xuXG4gICAgICAgIGF1dGhVc2VyLmlzVmFsaWRQYXNzd29yZChwYXNzd29yZCk7XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuYXV0aFRva2VuUmVwb3NpdG9yeS5nZW5lcmF0ZShhdXRoVXNlcik7XG4gICAgfVxufVxuIl0sInZlcnNpb24iOjN9