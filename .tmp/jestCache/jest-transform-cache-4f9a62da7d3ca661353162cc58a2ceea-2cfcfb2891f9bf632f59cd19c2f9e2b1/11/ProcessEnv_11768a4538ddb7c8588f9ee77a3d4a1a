17db442a007baee90add4e18a94d0bb5
"use strict";
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || function (mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
    __setModuleDefault(result, mod);
    return result;
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.EnvMode = void 0;
const fs = __importStar(require("fs"));
var EnvMode;
(function (EnvMode) {
    EnvMode[EnvMode["dev"] = 0] = "dev";
    EnvMode[EnvMode["test"] = 1] = "test";
    EnvMode[EnvMode["prod"] = 2] = "prod";
})(EnvMode = exports.EnvMode || (exports.EnvMode = {}));
class ProcessEnv {
    constructor() {
        this.env = {
            NODE_ENV: process.env.NODE_ENV,
            PORT: '3000',
            RABBITMQ_HOST: '',
            RABBITMQ_USER: '',
            RABBITMQ_PASSWORD: '',
            RABBITMQ_EXCHANGE: '',
            RABBITMQ_QUEUE: '',
            MYSQL_HOST: '',
            MYSQL_PORT: '',
            MYSQL_USER: '',
            MYSQL_PASSWORD: '',
            MYSQL_DATABASE: '',
        };
        // TODO Crear un DotEnv
        const modeEnvFilePath = `${__dirname}/../../.env.${process.env.NODE_ENV}`;
        if (fs.existsSync(modeEnvFilePath)) {
            require('dotenv').config({ path: modeEnvFilePath });
        }
        else {
            const envFilePath = `${__dirname}/../../.env`;
            if (fs.existsSync(envFilePath)) {
                require('dotenv').config({ path: envFilePath });
            }
        }
        const envKeys = Object.keys(this.env);
        for (const key of envKeys) {
            const value = process.env[key];
            if (value) {
                this.env[key] = value;
            }
            else {
                throw new Error(`Missing env key ${key}`);
            }
        }
        if (!Object.keys(EnvMode).includes(this.get('NODE_ENV'))) {
            throw new Error('Invalid NODE_ENV value.');
        }
    }
    get(key) {
        return this.env[key];
    }
    set(key, value) {
        this.env[key] = value;
    }
}
exports.default = ProcessEnv;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2N1YXRyb29jaGVudGEvTWFnaWNTaG9wcGVyL21hZ2ljc2hvcHBlci1ub2RlL3NyYy9hcHAvUHJvY2Vzc0Vudi50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBRUEsdUNBQXlCO0FBRXpCLElBQVksT0FJWDtBQUpELFdBQVksT0FBTztJQUNmLG1DQUFHLENBQUE7SUFDSCxxQ0FBSSxDQUFBO0lBQ0oscUNBQUksQ0FBQTtBQUNSLENBQUMsRUFKVyxPQUFPLEdBQVAsZUFBTyxLQUFQLGVBQU8sUUFJbEI7QUFtQkQsTUFBcUIsVUFBVTtJQUczQjtRQUNJLElBQUksQ0FBQyxHQUFHLEdBQUc7WUFDUCxRQUFRLEVBQUUsT0FBTyxDQUFDLEdBQUcsQ0FBQyxRQUFRO1lBQzlCLElBQUksRUFBRSxNQUFNO1lBRVosYUFBYSxFQUFFLEVBQUU7WUFDakIsYUFBYSxFQUFFLEVBQUU7WUFDakIsaUJBQWlCLEVBQUUsRUFBRTtZQUNyQixpQkFBaUIsRUFBRSxFQUFFO1lBQ3JCLGNBQWMsRUFBRSxFQUFFO1lBRWxCLFVBQVUsRUFBRSxFQUFFO1lBQ2QsVUFBVSxFQUFFLEVBQUU7WUFDZCxVQUFVLEVBQUUsRUFBRTtZQUNkLGNBQWMsRUFBRSxFQUFFO1lBQ2xCLGNBQWMsRUFBRSxFQUFFO1NBQ3JCLENBQUM7UUFFRix1QkFBdUI7UUFDdkIsTUFBTSxlQUFlLEdBQUcsR0FBRyxTQUFTLGVBQWUsT0FBTyxDQUFDLEdBQUcsQ0FBQyxRQUFRLEVBQUUsQ0FBQztRQUMxRSxJQUFJLEVBQUUsQ0FBQyxVQUFVLENBQUMsZUFBZSxDQUFDLEVBQUU7WUFDaEMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxFQUFFLElBQUksRUFBRSxlQUFlLEVBQUUsQ0FBQyxDQUFDO1NBQ3ZEO2FBQU07WUFDSCxNQUFNLFdBQVcsR0FBRyxHQUFHLFNBQVMsYUFBYSxDQUFDO1lBQzlDLElBQUksRUFBRSxDQUFDLFVBQVUsQ0FBQyxXQUFXLENBQUMsRUFBRTtnQkFDNUIsT0FBTyxDQUFDLFFBQVEsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxFQUFFLElBQUksRUFBRSxXQUFXLEVBQUUsQ0FBQyxDQUFDO2FBQ25EO1NBQ0o7UUFFRCxNQUFNLE9BQU8sR0FBRyxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQXdCLENBQUM7UUFFN0QsS0FBSyxNQUFNLEdBQUcsSUFBSSxPQUFPLEVBQUU7WUFDdkIsTUFBTSxLQUFLLEdBQUcsT0FBTyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQztZQUUvQixJQUFJLEtBQUssRUFBRTtnQkFDUCxJQUFJLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxHQUFHLEtBQUssQ0FBQzthQUN6QjtpQkFBTTtnQkFDSCxNQUFNLElBQUksS0FBSyxDQUFDLG1CQUFtQixHQUFHLEVBQUUsQ0FBQyxDQUFDO2FBQzdDO1NBQ0o7UUFFRCxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxVQUFVLENBQUMsQ0FBQyxFQUFFO1lBQ3RELE1BQU0sSUFBSSxLQUFLLENBQUMseUJBQXlCLENBQUMsQ0FBQztTQUM5QztJQUNMLENBQUM7SUFFTSxHQUFHLENBQXlCLEdBQU07UUFDckMsT0FBTyxJQUFJLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQ3pCLENBQUM7SUFFTSxHQUFHLENBQXlCLEdBQU0sRUFBRSxLQUFnQjtRQUN2RCxJQUFJLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxHQUFHLEtBQUssQ0FBQztJQUMxQixDQUFDO0NBQ0o7QUF4REQsNkJBd0RDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy9jdWF0cm9vY2hlbnRhL01hZ2ljU2hvcHBlci9tYWdpY3Nob3BwZXItbm9kZS9zcmMvYXBwL1Byb2Nlc3NFbnYudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyogZXNsaW50LWRpc2FibGUgbm8tdW5kZWYsIEB0eXBlc2NyaXB0LWVzbGludC9uby12YXItcmVxdWlyZXMgKi9cbmltcG9ydCBFbnYgZnJvbSAnQG1pY3Jvay9jb3JlL2RvbWFpbi9FbnYnO1xuaW1wb3J0ICogYXMgZnMgZnJvbSAnZnMnO1xuXG5leHBvcnQgZW51bSBFbnZNb2RlIHtcbiAgICBkZXYsXG4gICAgdGVzdCxcbiAgICBwcm9kLFxufVxuXG5leHBvcnQgaW50ZXJmYWNlIEVudktleSB7XG4gICAgTk9ERV9FTlY6IHN0cmluZztcbiAgICBQT1JUOiBzdHJpbmc7XG5cbiAgICBSQUJCSVRNUV9IT1NUOiBzdHJpbmc7XG4gICAgUkFCQklUTVFfVVNFUjogc3RyaW5nO1xuICAgIFJBQkJJVE1RX1BBU1NXT1JEOiBzdHJpbmc7XG4gICAgUkFCQklUTVFfRVhDSEFOR0U6IHN0cmluZztcbiAgICBSQUJCSVRNUV9RVUVVRTogc3RyaW5nO1xuXG4gICAgTVlTUUxfSE9TVDogc3RyaW5nO1xuICAgIE1ZU1FMX1BPUlQ6IHN0cmluZztcbiAgICBNWVNRTF9VU0VSOiBzdHJpbmc7XG4gICAgTVlTUUxfUEFTU1dPUkQ6IHN0cmluZztcbiAgICBNWVNRTF9EQVRBQkFTRTogc3RyaW5nO1xufVxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQcm9jZXNzRW52IGltcGxlbWVudHMgRW52PEVudktleT4ge1xuICAgIHByaXZhdGUgcmVhZG9ubHkgZW52OiBFbnZLZXk7XG5cbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5lbnYgPSB7XG4gICAgICAgICAgICBOT0RFX0VOVjogcHJvY2Vzcy5lbnYuTk9ERV9FTlYsXG4gICAgICAgICAgICBQT1JUOiAnMzAwMCcsXG5cbiAgICAgICAgICAgIFJBQkJJVE1RX0hPU1Q6ICcnLFxuICAgICAgICAgICAgUkFCQklUTVFfVVNFUjogJycsXG4gICAgICAgICAgICBSQUJCSVRNUV9QQVNTV09SRDogJycsXG4gICAgICAgICAgICBSQUJCSVRNUV9FWENIQU5HRTogJycsXG4gICAgICAgICAgICBSQUJCSVRNUV9RVUVVRTogJycsXG5cbiAgICAgICAgICAgIE1ZU1FMX0hPU1Q6ICcnLFxuICAgICAgICAgICAgTVlTUUxfUE9SVDogJycsXG4gICAgICAgICAgICBNWVNRTF9VU0VSOiAnJyxcbiAgICAgICAgICAgIE1ZU1FMX1BBU1NXT1JEOiAnJyxcbiAgICAgICAgICAgIE1ZU1FMX0RBVEFCQVNFOiAnJyxcbiAgICAgICAgfTtcblxuICAgICAgICAvLyBUT0RPIENyZWFyIHVuIERvdEVudlxuICAgICAgICBjb25zdCBtb2RlRW52RmlsZVBhdGggPSBgJHtfX2Rpcm5hbWV9Ly4uLy4uLy5lbnYuJHtwcm9jZXNzLmVudi5OT0RFX0VOVn1gO1xuICAgICAgICBpZiAoZnMuZXhpc3RzU3luYyhtb2RlRW52RmlsZVBhdGgpKSB7XG4gICAgICAgICAgICByZXF1aXJlKCdkb3RlbnYnKS5jb25maWcoeyBwYXRoOiBtb2RlRW52RmlsZVBhdGggfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBlbnZGaWxlUGF0aCA9IGAke19fZGlybmFtZX0vLi4vLi4vLmVudmA7XG4gICAgICAgICAgICBpZiAoZnMuZXhpc3RzU3luYyhlbnZGaWxlUGF0aCkpIHtcbiAgICAgICAgICAgICAgICByZXF1aXJlKCdkb3RlbnYnKS5jb25maWcoeyBwYXRoOiBlbnZGaWxlUGF0aCB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGVudktleXMgPSBPYmplY3Qua2V5cyh0aGlzLmVudikgYXMgQXJyYXk8a2V5b2YgRW52S2V5PjtcblxuICAgICAgICBmb3IgKGNvbnN0IGtleSBvZiBlbnZLZXlzKSB7XG4gICAgICAgICAgICBjb25zdCB2YWx1ZSA9IHByb2Nlc3MuZW52W2tleV07XG5cbiAgICAgICAgICAgIGlmICh2YWx1ZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuZW52W2tleV0gPSB2YWx1ZTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBNaXNzaW5nIGVudiBrZXkgJHtrZXl9YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIU9iamVjdC5rZXlzKEVudk1vZGUpLmluY2x1ZGVzKHRoaXMuZ2V0KCdOT0RFX0VOVicpKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIE5PREVfRU5WIHZhbHVlLicpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIGdldDxUIGV4dGVuZHMga2V5b2YgRW52S2V5PihrZXk6IFQpOiBFbnZLZXlbVF0ge1xuICAgICAgICByZXR1cm4gdGhpcy5lbnZba2V5XTtcbiAgICB9XG5cbiAgICBwdWJsaWMgc2V0PFQgZXh0ZW5kcyBrZXlvZiBFbnZLZXk+KGtleTogVCwgdmFsdWU6IEVudktleVtUXSkge1xuICAgICAgICB0aGlzLmVudltrZXldID0gdmFsdWU7XG4gICAgfVxufVxuIl0sInZlcnNpb24iOjN9