7b668843307d34482b90ff521135fd10
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.EventSubscriberMapper = void 0;
class EventSubscriberMapper {
    constructor(domainEventSubscribers) {
        this.domainEventSubscribersMap = this.formatEventSubscribers(domainEventSubscribers);
    }
    formatEventSubscribers(domainEventSubscribers) {
        const domainEventSubscribersMap = new Map();
        domainEventSubscribers.forEach((domainEventSubscriber) => {
            domainEventSubscriber.subscribedTo().forEach((domainEventClass) => {
                let domainEventSubscribersInMap = domainEventSubscribersMap.get(domainEventClass.EVENT_NAME.value());
                if (!domainEventSubscribersInMap) {
                    domainEventSubscribersInMap = [];
                }
                domainEventSubscribersInMap.push(domainEventSubscriber);
                domainEventSubscribersMap.set(domainEventClass.EVENT_NAME.value(), domainEventSubscribersInMap);
            });
        });
        return domainEventSubscribersMap;
    }
    search(messageName) {
        const domainEventSubscribers = this.domainEventSubscribersMap.get(messageName.value());
        if (!domainEventSubscribers) {
            return [];
        }
        return domainEventSubscribers;
    }
}
exports.EventSubscriberMapper = EventSubscriberMapper;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2N1YXRyb29jaGVudGEvTWFnaWNTaG9wcGVyL21hZ2ljc2hvcHBlci1ub2RlL3NyYy9taWNyb2svZXZlbnQvaW5mcmFzdHJ1Y3R1cmUvRXZlbnRTdWJzY3JpYmVyTWFwcGVyLnRzIiwibWFwcGluZ3MiOiI7OztBQUtBLE1BQWEscUJBQXFCO0lBRzlCLFlBQVksc0JBQTJEO1FBQ25FLElBQUksQ0FBQyx5QkFBeUIsR0FBRyxJQUFJLENBQUMsc0JBQXNCLENBQUMsc0JBQXNCLENBQUMsQ0FBQztJQUN6RixDQUFDO0lBRU8sc0JBQXNCLENBQzFCLHNCQUEyRDtRQUUzRCxNQUFNLHlCQUF5QixHQUFHLElBQUksR0FBRyxFQUErQyxDQUFDO1FBRXpGLHNCQUFzQixDQUFDLE9BQU8sQ0FBQyxDQUFDLHFCQUFxQixFQUFFLEVBQUU7WUFDckQscUJBQXFCLENBQUMsWUFBWSxFQUFFLENBQUMsT0FBTyxDQUFDLENBQUMsZ0JBQWdCLEVBQUUsRUFBRTtnQkFDOUQsSUFBSSwyQkFBMkIsR0FBRyx5QkFBeUIsQ0FBQyxHQUFHLENBQUMsZ0JBQWdCLENBQUMsVUFBVSxDQUFDLEtBQUssRUFBRSxDQUFDLENBQUM7Z0JBQ3JHLElBQUksQ0FBQywyQkFBMkIsRUFBRTtvQkFDOUIsMkJBQTJCLEdBQUcsRUFBRSxDQUFDO2lCQUNwQztnQkFDRCwyQkFBMkIsQ0FBQyxJQUFJLENBQUMscUJBQXFCLENBQUMsQ0FBQTtnQkFDdkQseUJBQXlCLENBQUMsR0FBRyxDQUFDLGdCQUFnQixDQUFDLFVBQVUsQ0FBQyxLQUFLLEVBQUUsRUFBRSwyQkFBMkIsQ0FBQyxDQUFBO1lBQ25HLENBQUMsQ0FBQyxDQUFBO1FBQ04sQ0FBQyxDQUFDLENBQUM7UUFFSCxPQUFPLHlCQUF5QixDQUFDO0lBQ3JDLENBQUM7SUFFTSxNQUFNLENBQUMsV0FBd0I7UUFDbEMsTUFBTSxzQkFBc0IsR0FBRyxJQUFJLENBQUMseUJBQXlCLENBQUMsR0FBRyxDQUFDLFdBQVcsQ0FBQyxLQUFLLEVBQUUsQ0FBQyxDQUFDO1FBRXZGLElBQUksQ0FBQyxzQkFBc0IsRUFBRTtZQUN6QixPQUFPLEVBQUUsQ0FBQztTQUNiO1FBRUQsT0FBTyxzQkFBc0IsQ0FBQztJQUNsQyxDQUFDO0NBQ0o7QUFuQ0Qsc0RBbUNDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy9jdWF0cm9vY2hlbnRhL01hZ2ljU2hvcHBlci9tYWdpY3Nob3BwZXItbm9kZS9zcmMvbWljcm9rL2V2ZW50L2luZnJhc3RydWN0dXJlL0V2ZW50U3Vic2NyaWJlck1hcHBlci50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBNYXBwZXIgfSBmcm9tICcuLi8uLi9jb21tb24vTWFwcGVyJztcbmltcG9ydCBNZXNzYWdlTmFtZSBmcm9tICcuLi8uLi9jb21tb24vbWVzc2FnZS9NZXNzYWdlTmFtZSc7XG5pbXBvcnQgRG9tYWluRXZlbnQgZnJvbSAnLi4vZG9tYWluL0RvbWFpbkV2ZW50JztcbmltcG9ydCBFdmVudFN1YnNjcmliZXIgZnJvbSAnLi4vZG9tYWluL0V2ZW50U3Vic2NyaWJlcic7XG5cbmV4cG9ydCBjbGFzcyBFdmVudFN1YnNjcmliZXJNYXBwZXIgaW1wbGVtZW50cyBNYXBwZXI8TWVzc2FnZU5hbWUsIEV2ZW50U3Vic2NyaWJlcjxEb21haW5FdmVudD5bXT4ge1xuICAgIHByaXZhdGUgZG9tYWluRXZlbnRTdWJzY3JpYmVyc01hcDogTWFwPHN0cmluZywgQXJyYXk8RXZlbnRTdWJzY3JpYmVyPERvbWFpbkV2ZW50Pj4+O1xuXG4gICAgY29uc3RydWN0b3IoZG9tYWluRXZlbnRTdWJzY3JpYmVyczogQXJyYXk8RXZlbnRTdWJzY3JpYmVyPERvbWFpbkV2ZW50Pj4pIHtcbiAgICAgICAgdGhpcy5kb21haW5FdmVudFN1YnNjcmliZXJzTWFwID0gdGhpcy5mb3JtYXRFdmVudFN1YnNjcmliZXJzKGRvbWFpbkV2ZW50U3Vic2NyaWJlcnMpO1xuICAgIH1cblxuICAgIHByaXZhdGUgZm9ybWF0RXZlbnRTdWJzY3JpYmVycyhcbiAgICAgICAgZG9tYWluRXZlbnRTdWJzY3JpYmVyczogQXJyYXk8RXZlbnRTdWJzY3JpYmVyPERvbWFpbkV2ZW50Pj4sXG4gICAgKTogTWFwPHN0cmluZywgQXJyYXk8RXZlbnRTdWJzY3JpYmVyPERvbWFpbkV2ZW50Pj4+IHtcbiAgICAgICAgY29uc3QgZG9tYWluRXZlbnRTdWJzY3JpYmVyc01hcCA9IG5ldyBNYXA8c3RyaW5nLCBBcnJheTxFdmVudFN1YnNjcmliZXI8RG9tYWluRXZlbnQ+Pj4oKTtcblxuICAgICAgICBkb21haW5FdmVudFN1YnNjcmliZXJzLmZvckVhY2goKGRvbWFpbkV2ZW50U3Vic2NyaWJlcikgPT4ge1xuICAgICAgICAgICAgZG9tYWluRXZlbnRTdWJzY3JpYmVyLnN1YnNjcmliZWRUbygpLmZvckVhY2goKGRvbWFpbkV2ZW50Q2xhc3MpID0+IHtcbiAgICAgICAgICAgICAgICBsZXQgZG9tYWluRXZlbnRTdWJzY3JpYmVyc0luTWFwID0gZG9tYWluRXZlbnRTdWJzY3JpYmVyc01hcC5nZXQoZG9tYWluRXZlbnRDbGFzcy5FVkVOVF9OQU1FLnZhbHVlKCkpO1xuICAgICAgICAgICAgICAgIGlmICghZG9tYWluRXZlbnRTdWJzY3JpYmVyc0luTWFwKSB7XG4gICAgICAgICAgICAgICAgICAgIGRvbWFpbkV2ZW50U3Vic2NyaWJlcnNJbk1hcCA9IFtdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBkb21haW5FdmVudFN1YnNjcmliZXJzSW5NYXAucHVzaChkb21haW5FdmVudFN1YnNjcmliZXIpXG4gICAgICAgICAgICAgICAgZG9tYWluRXZlbnRTdWJzY3JpYmVyc01hcC5zZXQoZG9tYWluRXZlbnRDbGFzcy5FVkVOVF9OQU1FLnZhbHVlKCksIGRvbWFpbkV2ZW50U3Vic2NyaWJlcnNJbk1hcClcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiBkb21haW5FdmVudFN1YnNjcmliZXJzTWFwO1xuICAgIH1cblxuICAgIHB1YmxpYyBzZWFyY2gobWVzc2FnZU5hbWU6IE1lc3NhZ2VOYW1lKTogQXJyYXk8RXZlbnRTdWJzY3JpYmVyPERvbWFpbkV2ZW50Pj4ge1xuICAgICAgICBjb25zdCBkb21haW5FdmVudFN1YnNjcmliZXJzID0gdGhpcy5kb21haW5FdmVudFN1YnNjcmliZXJzTWFwLmdldChtZXNzYWdlTmFtZS52YWx1ZSgpKTtcblxuICAgICAgICBpZiAoIWRvbWFpbkV2ZW50U3Vic2NyaWJlcnMpIHtcbiAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBkb21haW5FdmVudFN1YnNjcmliZXJzO1xuICAgIH1cbn1cbiJdLCJ2ZXJzaW9uIjozfQ==